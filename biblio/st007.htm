<html>
<head>
<title>TreeView на листе бумаги</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
<link rel="icon" href="../favicon.ico" />
</head>
<body bgcolor="white">
<div class="body_div">
<table class="tft" width="100%"><tr>
<td width="20%" align="center"><a href="../index.html"><img SRC="../vl1.gif" WIDTH="177" HEIGHT="80" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="10%" align="center">&nbsp;</td>
<td class='menutd' width="70%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="../reg.htm">О форумах</a>
<br/>
 <a class="menu" href="../bib.htm">Библиотека</a> |
 <a class="menu" href="../faq.htm">Частые вопросы</a> |
 <a class="menu" href="../bookpdf.htm">Литература</a> |
 <a class="menu" href="../loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="../navi/png_1.htm">Visio Navigator</a> |
 <a class="menu" href="../blog/">Blog</a> |
 <a class="menu" href="../inforesurs.htm">Полезные ссылки</a> |
 <a class="menu" href="../site.htm">О сайте</a>
<br/>
 <a class="menu" href="../visicorp.htm">История Visio</a> |
 <a class="menu" href="../product.htm">Продукты Visio</a>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- основной контент -->

<h1>TreeView на листе бумаги</h1>
<p align="right">Туманов Г.Е.</p>

<p align="Justify">Элемент TreeView, отображающий иерархическую структуру в виде
дерева, уже давно стал привычным во многих приложениях. Чаще всего им пользуются
для выбора нужной папки в "Проводнике", но как часто не хватает инструмента, чтобы
отобразить то же самое на бумаге.</p>
<p align="Justify">Разделаться, наконец, с этой задачей позволит небольшое Visio
приложение, о котором здесь говорится.</p>
<p align="Justify">Приложение состоит из рисунка-заготовки Visio и специального
трафарета. Все свернуто в архив <a href="../store/treeview.zip">treeview.zip</a>.
Для установки нужно просто разархивировать
файлы, рисунок D2.vsd положить в любое место, там где вы будете с ним работать,
а трафарет Fold.vss лучше всего разместить в папке Solutions, там где лежат
остальные трафареты Visio.</p>
<p align="Justify">Когда понадобится нарисовать структуру каталогов вашего
компьютера (или фрагмент этой структуры), открываете рисунок D2.vsd и видите
пустой лист и трафарет Fold. В меню Tools/Macros должна быть видна папочка ThisDocument,
а в ней два макроса - ttt и Branch.</p>
<table border="0" width="80%">
<tr><td width="40%" align="center"><img src="d2.gif" height="78" width="48" alt="" border="0" /><td>
<td width="60%">Выполнив макрос ttt вы получите первую ветвь
дерева - набор дисков вашего компьютера.</td></tr>
</table>
<table border="0" width="80%">
<tr><td width="40%" align="center"><img src="d3.gif" height="229" width="277" alt="" border="0" /><td>
<td width="60%">В выпадающем меню, которое раскрывается по щелчку правой кнопки
мыши на любой из нарисованных папок, есть пункт "Раскрыть". Он раскрывает в качестве
ветви дерева следующий уровень папок. Продолжая дальнейшее раскрытие, вы можете
получить любой фрагмент полного дерева каталогов компьютера.</td></tr>
</table>
<p align="Justify">Несущественные папки можно удалить, размещение приходится
поправлять в зависимости от длины имени отображаемой структуры. Изображение
всех папок одинаковое.</p>
<p align="Justify">Если требуется отобразить структуру каталогов на другом компьютере,
подключенном, например, к локальной сети, то нужно сначала через проводник подключить
выбранный диск в качестве сетевого, а затем действовать уже описанным методом.</p>
<p align="Justify">Приложение не блещет оформлением, но делалось оно для себя,
а мне этого оказалось достаточно. Если что-то понадобится усовершенствовать, то
исходный код макросов открыт и доступен для доработки. Следует только помнить,
что для доступа к каталогам компьютера используется объект  FileSystemObject,
поэтому к проекту должна быть подключена библиотечка Microsoft Scripting Runtime.</p>
<p align="Justify"><b><i>Макрос ttt</i></b></p>
<p align="Justify">Создает экземпляр FileSystemObject, получает коллекцию дисков
и сохраняет ее во временном массиве names. Затем, пользуясь мастер-шейпом Folder
с трафарета Fold.vss, отображает на листе рисунка нужное число папок, смещая каждое
следующее изображение на 10 мм (1/5.08 дюйма). Путь (для последующего доступа)
сохраняется в пользовательском свойстве шейпа.</p>
<p align="Justify"><b><i>Макрос Branch</i></b></p>
<p align="Justify">Вызывается через меню шейпа (это свойство отражено в мастер-шейпе).
Через объект Selection вычисляет, какой шейп его вызвал, и сохраняет начальные
координаты раскрывающейся ветви на 20 мм правее и 10 мм ниже вызывающего шейпа.</p>
<p align="Justify">Создает FileSystemObject и получает из него список подпапок
указанной папки. Полный путь папки-родителя берется из пользовательского свойства
вызывающего шейпа.</p>
<p align="Justify">Ветвь подпапок прорисовывается примерно так же, как и ветвь
дисков в предыдущем макросе. Дополнительно первый шейп ветви соединяется универсальным
коннектором с вызывающим шейпом.</p>
<p align="Justify">Вот, собственно, и весь несложный механизм. Если понадобится
помощь при модернизации, пишите.</p>
<p align="Justify">Все исходные материалы
можно взять для подробного рассмотрения в <a href="../store/treeview.zip">zip-архиве</a>.</p>

<!-- --------------------------- -->
<div id="menu-line">
<a href="mailto:gCroc@yandex.ru">Gennady Tumanov</a>
</div>

</div>
</body>
</html>

